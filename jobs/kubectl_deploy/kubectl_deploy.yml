# Job from R2Devops hub --> r2devops.io

stages:
  - deploy

kubectl_deploy:
  image: nekottyo/kustomize-kubeval:latest
  stage: deploy
  variables:
    FILES_LOCATION: ""
    KUBECTL_OPTIONS: ""

  script:
  - kubectl apply -f $FILES_LOCATION $KUBECTL_OPTIONS | tee -a output.log

  environment:
      name: main/${CI_COMMIT_REF_SLUG}

  artifacts:
    expose_as: "Kubectl job output"
    paths:
      - output.log

  rules:
    - if: '$CI_COMMIT_BRANCH == $CI_DEFAULT_BRANCH'